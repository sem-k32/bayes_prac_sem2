# $\alpha$-расширение

## д)

В качестве парных потенциалов мы по прежденему будем использовать модель Поттса и учитывать различность пикселей, но делать это теперь необходимо с помощью метрики на векторах для выполнения неравенства треугольника (субмодулярности потенциалов):

$$
    \Theta_{ij}(\gamma, \beta) = \alpha \cdot \lVert \text{pix}(\gamma) - \text{pix}(\beta) \rVert \cdot [\gamma \not= \beta]
$$

Здесь $ \alpha $ - шкалирующий гиперпараметр. Легко видеть, что $ \Theta_{ij}(\gamma, \gamma) = 0, \ \forall \gamma $. Если рассмотреть неравенство треугольника:

$$
    \Theta_{ij}(\beta, \alpha) + \Theta_{ij}(\alpha, \gamma) \ge \Theta_{ij}(\beta, \gamma)
$$

При $ \alpha = \beta $ или $ \alpha = \gamma $ из предыдущего вопроса неравенство выполнено. При $ \gamma = \beta $ справа получаем ноль, слева неотрицательное выражение - всё выполнено. В противном случае все переменные различны, и неравенство выполнено по свойствам векторной нормы.

В качестве единичных потенциалов брались константы, кроме случаев наперёд заданных классов для некоторых групп пикселей. В этом случае:

$$
    \Theta_i(\alpha) = \begin{cases}
                            +\infty, \ \alpha \not= \text{заданному классу} \\
                            const, \ \text{иначе}
                        \end{cases}
$$

## е)

В ```src/``` реализован алгоритм $\alpha$-расширения без определения потенциалов и системы соседства. Там же находится скритп его расширения с настроенными парными потенциалами. Система соседства и унарные потенциалы определялись в скриптах эксперимента.

$\alpha$-расширение в своих итерациях опирается на Graph Cut, а он опирается на эквивалентность разреза графа и значения энергии для конкрентной классификации пикселей. Для этой эквивалентности требуется условие субмодулярности, которая при $ \Theta_{ij}(\gamma, \gamma) = 0, \ \forall \gamma $ превращается в неравнество треугольника. При невыполнении этих условий применять Graph Cut некорректно, т.к. потенциалы нельзя привести к тому виду, который предполагает этот алгоритм.

## ж)

В ```experiments``` содержатся результаты для двух наборов фото. Результат содержит итоговый коллаж, а также изменение маски коллажа после каждой итерации $\alpha$-расширения.

- ```experiments/experiment_1```: начальная маска коллажа инициализировалась классом 1. Другие инициализации (случайная или другим классом) завершались слишком рано. Для *results_ones_init* и *results_ones_init_1* были выбраны немного разные масштабирующие гиперпараметры ($ \alpha = 2 $ и $ \alpha = 5 $) для оценивания его влияния (в теории влияния нет). Тем не менее коллажи отличались, в разных фото рядом стоящие предметы получали больше/меньше пикселей. Также алгоритм был запущен на предварительно обесцвеченных изображениях ```greyscale/```, который показал наилучший [результат](experiments/experiment_1/greyscale/results_greyscale_preproc/collage.png). К сожалению, границы для фото №2 не подстравились под контуры его предметов, из-за чего эта часть коллажа выглядит неправдоподобно.


